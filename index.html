<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Fall of Babel: Architect Mode IX (Entropy)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <link rel="stylesheet" href="src/styles.css">
</head>
<body class="mode-shatter">

    <div id="ui-layer">
        <div id="bg-reference"></div>
        <div class="grain"></div>
        <div class="vignette"></div>
        <div id="audio-status">AUDIO ENGINE :: ONLINE</div>
        <div id="tooltip" data-key="tooltip">[SHIFT] Snap Axis • [CTRL+Z] Undo</div>
        <div id="typing-buffer-display"></div>
        <div id="settings-trigger">[ ☼ ]</div>
        
        <div id="control-panel">
            
            <div class="panel-header">
                <h2 data-key="h_lang">UI LANGUAGE</h2>
                <div class="control-group mode-toggle-group" style="margin-bottom: 15px;">
                    <button id="btn-lang-en" class="active">ENGLISH</button>
                    <button id="btn-lang-zh">中文</button>
                </div>

                <h2 data-key="h_cursor">CURSOR MODE</h2>
                <div class="control-group mode-toggle-group">
                    <button id="btn-mode-drag" data-key="btn_manipulate">MANIPULATE</button>
                    <button id="btn-mode-shatter" class="active" data-key="btn_disrupt">DISRUPT</button>
                    <button id="btn-mode-draw" data-key="btn_architect">ARCHITECT</button>
                </div>
                <div id="architect-controls" class="control-group">
                    <div class="label-row" style="margin-bottom:5px;"><span data-key="lbl_tool">TOOL</span></div>
                    <div class="mode-toggle-group">
                        <button id="btn-tool-free" class="active" data-key="btn_free">FREE</button>
                        <button id="btn-tool-line" data-key="btn_line">LINE</button>
                        <button id="btn-tool-fan" data-key="btn_fan">FAN</button>
                        <button id="btn-tool-well">WELL</button>
                        <button id="btn-tool-erase" data-key="btn_erase">ERASE</button>
                    </div>
                </div>
            </div>

            <div class="tabs-nav">
                <button class="tab-btn active" data-target="tab-sim" data-key="tab_sim">SIM</button>
                <button class="tab-btn" data-target="tab-arch" data-key="tab_arch">ARCH</button>
                <button class="tab-btn" data-target="tab-vis" data-key="tab_vis">VIS</button>
                <button class="tab-btn" data-target="tab-data" data-key="tab_data">DATA</button>
            </div>

            <div class="panel-content">
                
                <div id="tab-sim" class="tab-section active">
                    <h2 data-key="h_spawn">SPAWN MODE</h2>
                    <div class="control-group mode-toggle-group">
                        <button id="btn-spawn-auto" class="active" data-key="btn_auto_drop">AUTO DROP</button>
                        <button id="btn-spawn-type" data-key="btn_type_input">TYPE INPUT</button>
                    </div>
                    
                    <div id="typing-settings" class="control-group" style="display:none; margin-top:5px; border-top:1px dashed #333; padding-top:10px;">
                        <div class="label-row" style="margin-bottom:5px;"><span data-key="lbl_input_method">INPUT METHOD</span></div>
                        <div class="mode-toggle-group">
                            <button id="btn-type-char" class="active" data-key="btn_1key">1 KEY = 1 CHAR</button>
                            <button id="btn-type-enter" data-key="btn_enter">DROP ON ENTER</button>
                        </div>
                        <div style="font-size:9px; color:#666; margin-top:5px;">
                            <span id="type-desc" data-key="desc_type_char">Press any key to drop a character.</span>
                        </div>
                    </div>

                    <h2 data-key="h_interaction">INTERACTION TRIGGER</h2>
                    <div class="control-group mode-toggle-group">
                        <button id="btn-trigger-click" class="active" data-key="btn_click">CLICK</button>
                        <button id="btn-trigger-hover" data-key="btn_hover">HOVER</button>
                    </div>

                    <h2 data-key="h_physics">PHYSICS</h2>
                    <div class="control-group">
                        <div class="label-row"><span data-key="lbl_gravity">GRAVITY</span><span id="val-gravity">1.0</span></div>
                        <input type="range" id="inp-gravity" min="0" max="2" step="0.1" value="1">
                    </div>
                    <div class="control-group">
                        <div class="label-row"><span data-key="lbl_force">FORCE</span><span id="val-force">0.12</span></div>
                        <input type="range" id="inp-force" min="0.01" max="0.5" step="0.01" value="0.12">
                    </div>

                    <h2 data-key="h_flow">FLOW (AUTO MODE)</h2>
                    <div class="control-group">
                        <div class="label-row"><span data-key="lbl_delay">DELAY</span><span id="val-speed">35</span></div>
                        <input type="range" id="inp-speed" min="5" max="100" step="1" value="35">
                    </div>
                    <div class="control-group" style="flex-direction:row; justify-content:space-between; align-items:center;">
                        <span style="font-size:10px; color:#888;" data-key="lbl_infinite">INFINITE LOOP</span>
                        <input type="checkbox" id="inp-loop" checked style="width:auto; margin:0;">
                    </div>

                    <h2 data-key="h_lifetime">LIFETIME</h2>
                    <div class="control-group">
                        <div class="label-row">
                            <span data-key="lbl_max_life">MAX EXISTENCE</span>
                            <span id="val-lifetime" style="color:var(--accent)">∞</span>
                        </div>
                        <input type="range" id="inp-lifetime" min="1" max="61" step="1" value="61">
                    </div>

                    <h2 data-key="h_maint">MAINTENANCE</h2>
                    <button id="btn-sweep" style="color:#eebb99; border-color:#664422;" data-key="btn_sweep">SWEEP DEBRIS</button>
                    <button id="btn-clear" style="color:#ff6666; border-color:#663333;" data-key="btn_purge">PURGE ALL</button>
                </div>

                <div id="tab-arch" class="tab-section">
                    <h2 data-key="h_blueprint">BLUEPRINT</h2>
                    <div class="control-group" style="display:flex; flex-direction:row; gap:5px;">
                        <button id="btn-save" style="flex:1;" data-key="btn_save">SAVE LAYOUT</button>
                        <button id="btn-load" style="flex:1;" data-key="btn_load">LOAD LAYOUT</button>
                    </div>

                    <h2 data-key="h_linetype">LINE TYPE</h2>
                    <div class="control-group mode-toggle-group">
                        <button id="btn-line-standard" class="active" data-key="btn_standard">STANDARD</button>
                        <button id="btn-line-kill" style="color:#ff7777;" data-key="btn_kill">KILL ZONE</button>
                        <button id="btn-line-bounce" style="color:#77aaff;" data-key="btn_bounce">BOUNCE PAD</button>
                        <button id="btn-line-portal" style="color:#66ffe6;" data-key="btn_portal">PORTAL</button>
                    </div>
                    <div style="font-size:9px; color:#666;" data-key="desc_lines">Kill zones vaporize text; bounce pads add 1.5x restitution.</div>
                    <div id="portal-controls" class="control-group" style="display:none;">
                        <div class="label-row"><span data-key="h_portal_orient">PORTAL ORIENTATION</span></div>
                        <div class="mode-toggle-group">
                            <button id="btn-portal-left" class="active" data-key="btn_portal_left">SIDE A</button>
                            <button id="btn-portal-right" data-key="btn_portal_right">SIDE B</button>
                        </div>
                        <div style="font-size:9px; color:#666; margin-top:6px;" data-key="desc_portal">Draw two lines: entry then exit.</div>
                    </div>

                    <h2 data-key="h_lineprop">LINE PROPERTIES</h2>
                    <div class="control-group">
                        <div class="label-row"><span data-key="lbl_friction">FRICTION</span><span id="val-friction">0.1</span></div>
                        <input type="range" id="inp-friction" min="0" max="1" step="0.05" value="0.1">
                    </div>
                    <div class="control-group">
                        <div class="label-row"><span data-key="lbl_thickness">THICKNESS</span><span id="val-thickness">4</span></div>
                        <input type="range" id="inp-thickness" min="2" max="40" step="1" value="4">
                    </div>

                    <h2 data-key="h_wind">WIND</h2>
                    <div class="control-group">
                        <div class="label-row"><span data-key="lbl_fan_dir">FAN DIRECTION</span></div>
                        <div class="mode-toggle-group">
                            <button id="btn-fan-left">←</button>
                            <button id="btn-fan-up" class="active">↑</button>
                            <button id="btn-fan-right">→</button>
                            <button id="btn-fan-down">↓</button>
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="label-row"><span data-key="lbl_fan_str">FAN STRENGTH</span><span id="val-fan-strength">0.0006</span></div>
                        <input type="range" id="inp-fan-strength" min="0" max="0.002" step="0.0001" value="0.0006">
                    </div>

                    <h2>GRAVITY WELL</h2>
                    <div class="control-group">
                        <div class="label-row"><span>STRENGTH</span><span id="val-well-strength">0.0009</span></div>
                        <input type="range" id="inp-well-strength" min="0" max="0.004" step="0.0001" value="0.0009">
                    </div>
                    <div class="control-group">
                        <div class="label-row"><span>RADIUS</span><span id="val-well-radius">220</span></div>
                        <input type="range" id="inp-well-radius" min="60" max="400" step="10" value="220">
                    </div>
                </div>

                <div id="tab-vis" class="tab-section">
                    <h2 data-key="h_typo">TYPOGRAPHY</h2>
                    <div class="control-group">
                        <div class="label-row"><span data-key="lbl_text_size">TEXT SIZE (RESETS)</span><span id="val-fontsize">22</span></div>
                        <input type="range" id="inp-fontsize" min="10" max="60" step="2" value="22">
                    </div>

                    <h2 data-key="h_palette">PALETTE</h2>
                    <div class="control-group">
                        <div class="label-row"><span data-key="lbl_line_col">LINE COLOR</span></div>
                        <div class="mode-toggle-group" id="line-color-picker">
                            <button data-col="#ffffff" style="background:#fff;" class="active"></button>
                            <button data-col="#eebb99" style="background:#eebb99;"></button>
                            <button data-col="#ff5555" style="background:#ff5555;"></button>
                            <button data-col="#5555ff" style="background:#5555ff;"></button>
                        </div>
                    </div>

                    <h2 data-key="h_ref">REFERENCE</h2>
                    <div class="control-group">
                        <div class="label-row"><span data-key="lbl_img_url">IMAGE URL</span></div>
                        <textarea id="inp-bg-url" placeholder="Paste image URL..." style="height:30px;"></textarea>
                        <div class="mode-toggle-group">
                            <button id="btn-load-bg" data-key="btn_load_img">LOAD</button>
                            <button id="btn-clear-bg" data-key="btn_clear_img">CLEAR</button>
                        </div>
                    </div>
                </div>

                <div id="tab-data" class="tab-section">
                    <h2 data-key="h_audio">AUDIO</h2>
                    <div class="control-group">
                        <button id="btn-audio-toggle" data-key="btn_init_audio">INITIALIZE AUDIO</button>
                    </div>
                    <div class="control-group">
                        <div class="label-row"><span data-key="lbl_vol_master">MASTER VOLUME</span><span id="val-vol">0.35</span></div>
                        <input type="range" id="inp-vol" min="0" max="1" step="0.05" value="0.35">
                    </div>
                    <div class="control-group">
                        <div class="label-row"><span data-key="lbl_vol_exp">EXPLOSION</span><span id="val-vol-explosion">1.4</span></div>
                        <input type="range" id="inp-vol-explosion" min="0" max="2" step="0.05" value="1.4">
                    </div>
                    <div class="control-group">
                        <div class="label-row"><span data-key="lbl_vol_col">COLLISION</span><span id="val-vol-collision">0.1</span></div>
                        <input type="range" id="inp-vol-collision" min="0" max="2" step="0.05" value="0.1">
                    </div>
                    <div class="control-group">
                        <div class="label-row"><span data-key="lbl_vol_bounce">BOUNCE</span><span id="val-vol-bounce">1.0</span></div>
                        <input type="range" id="inp-vol-bounce" min="0" max="2" step="0.05" value="1">
                    </div>
                    <div class="control-group">
                        <div class="label-row"><span data-key="lbl_vol_type">TYPING</span><span id="val-vol-typing">1.0</span></div>
                        <input type="range" id="inp-vol-typing" min="0" max="2" step="0.05" value="1">
                    </div>

                    <h2 data-key="h_source">SOURCE TEXT</h2>
                    <div class="control-group">
                        <textarea id="inp-text" placeholder="Paste custom text..."></textarea>
                        <button id="btn-update-text" data-key="btn_inject">INJECT NEW STREAM</button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="src/app.js"></script>
</body>
</html>
